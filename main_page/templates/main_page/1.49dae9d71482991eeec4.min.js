(window.webpackJsonp_wixSantaEditor=window.webpackJsonp_wixSantaEditor||[]).push([[1],{1041:function(e,t,a){"use strict";a.r(t),a.d(t,"utils",(function(){return Ye})),a.d(t,"getAppBuilderLayoutAPIs",(function(){return qe})),a.d(t,"AppPart",(function(){return ze}));var n={};a.r(n),a.d(n,"slider",(function(){return A})),a.d(n,"combobox",(function(){return b})),a.d(n,"checkbox",(function(){return S})),a.d(n,"textfield",(function(){return I})),a.d(n,"radioimages",(function(){return w})),a.d(n,"radiogroup",(function(){return N}));var i={};a.r(i),a.d(i,"getLinkHref",(function(){return te})),a.d(i,"rebuildTextWithLinks",(function(){return ae})),a.d(i,"sanitizeHtmlContent",(function(){return ie})),a.d(i,"getWixImageDescriptor",(function(){return se})),a.d(i,"getRichTextContent",(function(){return re})),a.d(i,"isNewsAppPartName",(function(){return oe})),a.d(i,"getSchemaFilePath",(function(){return le})),a.d(i,"getDataBindingApplicationId",(function(){return ce})),a.d(i,"provisionWixCodeIfNeeded",(function(){return pe})),a.d(i,"enableDataMode",(function(){return de})),a.d(i,"openContentManagerPanelIfNeeded",(function(){return me})),a.d(i,"refreshSchemasCacheForDataBindingApp",(function(){return ue}));var s=a(0),r=a.n(s),o=a(4),l=a.n(o),c=a(40),p=a(6),d=a(5),m=a(12),u=a(1),_=a.n(u),g=a(13),h=a.n(g),P=a(11),f=a(3),E=a.n(f),y=a(2);class A extends r.a.Component{constructor(){super(...arguments),this.getMinValue=()=>parseInt(this.props.minVal,10),this.getMaxValue=()=>parseInt(this.props.maxVal,10)}render(){return r.a.createElement(P.slider,{min:this.getMinValue(),max:this.getMaxValue(),step:this.props.step,infoText:this.props.infoText,valueLink:this.props.valueLink,label:this.props.label})}}A.displayName="SliderCustomization";class b extends r.a.Component{render(){return r.a.createElement(P.dropDown.select,{label:Object(p.translate)(this.props.label),valueLink:this.props.valueLink,shouldTranslate:!1},_.a.map(this.props.options,e=>r.a.createElement(P.dropDown.option,{value:e.value,shouldTranslate:this.props.shouldTranslateLabel},e.label)))}}b.displayName="DropdownCustomization";var O=a(10),T=a.n(O);class S extends r.a.Component{constructor(){super(...arguments),this.hasNeededExperiment=()=>void 0===this.props.experimentNeeded||T.a.isOpen(this.props.experimentNeeded),this.createBooleanValueLink=()=>{const e=this.props.valueLink;return{value:{true:!0,false:!1}[{true:this.props.trueVal,false:this.props.falseVal}[e.value]],requestChange:function(t){e.requestChange(String(t)===String(this.props.trueVal))}.bind(this)}}}render(){return this.hasNeededExperiment()?r.a.createElement(l.a.Composites.Checkboxes,{key:"toggleKey"},r.a.createElement(l.a.Composites.CheckboxWithInfoIcon,null,this.props.infoText?r.a.createElement(l.a.InfoIcon,{key:"checkboxInfo",title:this.props.infoTitle,text:this.props.infoText}):null,r.a.createElement(l.a.Checkbox,{labelAfterSymbol:!0,label:this.props.label,shouldTranslate:this.props.shouldTranslateLabel,valueLink:this.createBooleanValueLink()}))):null}}S.displayName="CheckboxCustomization";class I extends r.a.Component{render(){return r.a.createElement(P.textInput,{valueLink:this.props.valueLink,label:this.props.label,placeholder:this.props.placeholderText,infoText:this.props.infoText})}}I.displayName="TextfieldCustomization";class w extends r.a.Component{constructor(){super(...arguments),this.getOptions=()=>this.props.options.map((function(e){return{value:e.value,symbolName:e.icon}}))}render(){return r.a.createElement(P.thumbnails,{maxThumbsPerRow:"5",title:this.props.label,infoText:this.props.infoText,options:this.getOptions(),valueLink:this.props.valueLink})}}w.displayName="RadioimagesCustomization";class N extends r.a.Component{render(){return r.a.createElement(l.a.Composites.RadioButtonsLabeled,null,r.a.createElement(l.a.InfoIcon,{text:this.props.infoText}),r.a.createElement(l.a.TextLabel,{value:this.props.label}),r.a.createElement(l.a.RadioButtons,{value:this.props.valueLink.value,onChange:this.props.valueLink.requestChange,options:this.props.options}))}}N.displayName="radiogroup";var L=h()({displayName:"Customization",propTypes:{name:E.a.string.isRequired,valueLink:E.a.shape({value:E.a.any,requestChange:E.a.func})},mixins:[y.propTypesFilterMixin],getCustomizationControl(){const e=n[this.props.name];if(void 0===e)throw new Error("an adapter for ".concat(this.props.name," is not available"));return e},shouldTranslate(){let e=!0;return this.props.shouldTranslate&&(e={true:!0,false:!1}[this.props.shouldTranslate]),e},render(){const e=this.getCustomizationControl();return r.a.createElement(e,Object.assign({valueLink:this.props.valueLink,shouldTranslateLabel:this.shouldTranslate()},this.filteredProps()))}});const v=e=>{let t;return e.relatedComp?t=e.relatedComp.toLowerCase():"OlderPosts"===e.fieldId||"NewerPosts"===e.fieldId||"paginationNavigationBox"===e.fieldId?t="pagination":"monthsToShow"===e.key?t="month_range":"comp.autoplayInterval"===e.key||"comp.transition"===e.key||"comp.autoplay"===e.key?t="animation":"pagination"===e.fieldId&&(t="pagination_buttons"),t?"blog_divider_".concat(t):""};function C(e){return r.a.createElement(L,_.a.merge({},e.input,{valueLink:R.call(this,e)}))}function x(e){return r.a.createElement(P.checkableTextInput,{checkStateValueLink:j.call(this,{fieldId:e.checkStateFieldId,forType:e.forType,format:e.checkStateFormat,key:e.checkStateKey,view:e.view}),placeholderText:e.input.placeholderText,shouldDisableTextEditing:e.input.shouldDisableTextEditing,experimentNeeded:e.input.experimentNeeded,textValueLink:R.call(this,{fieldId:e.textFieldId,forType:e.forType,format:e.textFormat,key:e.textKey,view:e.view})})}function j(e){const t=R.call(this,e),a={requestChange(e){t.requestChange(String(e)),n()}};return n(),a;function n(){a.value="true"===String(t.value)}}function R(e){return this.props.compPanel.linkedCustomization(e)}class k extends r.a.Component{constructor(){super(...arguments),this.getComps=()=>{const e=this.props.compPanel,t=_()(this.props.customizations).sortBy("priority").reverse().filter((function(t){var a;const n=null===(a=null==t?void 0:t.input)||void 0===a?void 0:a.hiddenwhen;return _.a.set(n,"forType",t.forType),!e.evaluateHiddenWhenCondition(n)})).value();return _()(t).forEach((function(e){e.relatedComp=e.relatedComp||""})).forEach(this.addInfoIcons),_()(t).groupBy(v).toPairs().map((function(e){return{name:e[0],customizations:e[1]}})).sortBy((function(e){return e.name?e.customizations[0].priority:Number.MAX_VALUE})).reverse().value()},this.addInfoIcons=e=>(e.input&&e.toolTip&&(e.input.infoText=e.toolTip),e),this.renderCustomization=e=>{var t;switch(null===(t=e.input)||void 0===t?void 0:t.name){default:return C.call(this,e);case"checkabletextfield":return x.call(this,e)}}}render(){return r.a.createElement("div",null,_.a.map(this.getComps(),(e,t)=>r.a.createElement("div",{key:t},!e.name||this.props.isTopOfPage&&0===t?null:r.a.createElement(l.a.Divider,{long:!0,key:"TopOfPageDivider"}),!e.name||this.props.isTopOfPage&&0===t?null:r.a.createElement(P.sectionDividerLabeled,{label:e.name,key:"divider"}),e.name?r.a.createElement(l.a.Divider,{key:"longDivider",long:!0}):null,_.a.map(e.customizations,(t,a)=>r.a.createElement("div",{key:"customization_".concat(a)},this.renderCustomization(t),a!==e.customizations.length-1?r.a.createElement(l.a.Divider,{key:"longDividerInCustomization",long:!0}):null)))))}}k.displayName="customizationsContainer",k.propTypes={compPanel:E.a.shape({linkedCustomization:E.a.func.isRequired}),isTopOfPage:E.a.bool},k.defaultProps={isTopOfPage:!1};var D=a(14);const F={getParam(e,t){const a=e.value[t];if(a)return JSON.parse(a.value)},setParam(e,t,a){const n=e.value;let i=n[t];i||(i={type:"AppPartParam"}),i.value=JSON.stringify(a),n[t]=i},getParamProp(e,t,a){const n=F.getParam(e,t);if(n)return n[a]},setParamProp(e,t,a,n){let i=F.getParam(e,t);i||(i={}),i[a]=n,F.setParam(e,t,i)},removeParamProp(e,t,a){const n=F.getParam(e,t);n&&(delete n[a],F.setParam(e,t,n))},update(e){e.requestChange(e.value)}};var M=F,W=h()({displayName:"BlogPostFilter",propTypes:{appLogicParamsLink:E.a.shape({value:E.a.object.isRequired,requestChange:E.a.func.isRequired}).isRequired,appPartName:E.a.string,packageName:E.a.string},mixins:[D.mixins.editorAPIMixin,c.wixappsViewCacheInvalidationMixin],getAppLogicParamsLink(){return this.props.appLogicParamsLink},linkAppLogicParamFilterTags(){const e=this,t=e.getAppLogicParamsLink();return{value:M.getParamProp(t,"filter","tags")||"",requestChange(a){a?M.setParamProp(t,"filter","tags",a):M.removeParamProp(t,"filter","tags"),e.invalidateViewCache(),M.update(t)}}},linkAppLogicParamFilterFeatured(){const e=this,t=this.getAppLogicParamsLink();return{value:M.getParamProp(t,"filter","featured")||!1,requestChange(a){a?M.setParamProp(t,"filter","featured",a):M.removeParamProp(t,"filter","featured"),e.invalidateViewCache(),M.update(t)}}},linkAppLogicParamLimit(){const e=this,t=e.getAppLogicParamsLink();return{value:M.getParam(t,"limit")||10,requestChange(a){M.setParam(t,"limit",a),e.invalidateViewCache(),M.update(t)}}},linkAppLogicParamFilterCategoryName(){const e=this,t=e.getAppLogicParamsLink();return{value:_.a.head(M.getParam(t,"categoryNames"))||"",requestChange(a){a?M.setParam(t,"categoryNames",[a]):delete t.value.categoryNames,e.invalidateViewCache(),M.update(t)}}},hasAppLogicParamFilter(e){const t=this.getEditorAPI();return t?t.dsRead.wixapps.classics.getAppPartRole(this.props.packageName,this.props.appPartName)!==e:[]},getTagNames(){let e=[];const t=this.getEditorAPI();t&&(e=e.concat(t.dsRead.wixapps.classics.getTagNames()));const a=M.getParamProp(this.getAppLogicParamsLink(),"filter","tags");return a&&!_.a.includes(e,a)&&e.unshift(a),e.sort()},getFlattenedCategories(){const e=this.linkAppLogicParamFilterCategoryName().value,t=this.getEditorAPI();return t?t.dsRead.wixapps.classics.getBlogCategories(e):[]},render(){return r.a.createElement("div",{className:"blog-post-filter"},r.a.createElement(l.a.Divider,{long:!0}),this.hasAppLogicParamFilter("FEATURED_POSTS")?r.a.createElement("div",{key:"filter"},r.a.createElement(P.dropDown.select,{label:Object(p.translate)("BLOG_FILTER_VIEW_FILTER_BY_TAG"),valueLink:this.linkAppLogicParamFilterTags(),shouldTranslate:!1},r.a.createElement(P.dropDown.option,{key:"0",value:""},Object(p.translate)("BLOG_FILTER_VIEW_FILTER_ALL_TAGS")),_.a.map(this.getTagNames(),(e,t)=>r.a.createElement(P.dropDown.option,{key:t+1,value:e},e))),r.a.createElement(l.a.Divider,{long:!0}),r.a.createElement(P.dropDown.select,{label:Object(p.translate)("BLOG_FILTER_VIEW_FILTER_BY_CATEGORY"),valueLink:this.linkAppLogicParamFilterCategoryName(),shouldTranslate:!1},r.a.createElement(P.dropDown.option,{key:"0",value:""},Object(p.translate)("BLOG_FILTER_VIEW_FILTER_ALL_CATEGORIES")),_.a.map(this.getFlattenedCategories(),(e,t)=>r.a.createElement(P.dropDown.option,{key:t+1,value:e.name,className:Object(y.cx)({level1:e.isSubcategory})},e.name))),r.a.createElement(l.a.Divider,{long:!0}),r.a.createElement(l.a.Composites.Checkboxes,null,r.a.createElement(l.a.Checkbox,{label:"BLOG_FILTER_VIEW_SHOW_ONLY_FEATURED",labelAfterSymbol:!0,valueLink:this.linkAppLogicParamFilterFeatured()})),r.a.createElement(l.a.Divider,{long:!0})):null,this.hasAppLogicParamFilter("CUSTOM_FEED")?r.a.createElement(P.slider,Object.assign({label:"BLOG_FILTER_VIEW_MAX_POSTS",valueLink:this.linkAppLogicParamLimit(),key:"limit"},{min:1,max:50})):null)}}),B=h()({displayName:"WixappsSettingsPanel",mixins:[c.compPanelMixin,c.wixappsPanelMixin],getCustomizations(){const e=this.getAvailableCustomizations("settings");if(this.isMobileViewMode()&&this.isSinglePost()){const t=this.getAvailableCustomizations("settings",{format:"",viewName:"SocialShareSinglePostMobile"});return e.concat(t)}return e},hasBlogPostFilter(){const e=this.getEditorAPI().dsRead.wixapps.classics.getAppPartRole(this.getSelectedComponentPackageName(),this.data.appPartName);return _.a.includes(["CUSTOM_FEED","FEATURED_POSTS","POST_LIST","POST_GALLERY","TICKER"],e)},render(){return r.a.createElement(c.compPanelFrame,Object.assign({title:"".concat(this.getSelectedAppPartDisplayName(),"_settings"),contentClass:"settings-panel",helpId:this.getComponentHelpIdByType("settings")},this.getFrameProps()),this.hasBlogPostFilter()?r.a.createElement(W,{appLogicParamsLink:this.linkedData("appLogicParams"),appPartName:this.data.appPartName,packageName:this.getSelectedComponentPackageName(),key:"postFilter"}):null,r.a.createElement(k,{customizations:this.getCustomizations(),compPanel:this,isTopOfPage:!this.hasBlogPostFilter()}))}}),X=a(35),G=a(7),U=a(21);const V=_.a.values(d.LEGACY_WIX_APPS_NAMES);var Y,q;!function(e){e.WIX_RESTAURANTS_MENUS="13c1402c-27f2-d4ab-7463-ee7c89e07578",e.WIX_FAQ="14c92d28-031e-7910-c9a8-a670011e062d"}(Y||(Y={})),function(e){e.CTA="wix-apps-deprecation-panel-cta",e.SAVE_DATA_CTA="wix-apps-deprecation-panel-save-data-cta",e.LEARN_MORE="wix-apps-deprecation-panel-learn-more",e.PANEL_FRAME="wix-apps-deprecation-panel-frame"}(q||(q={}));const z={PANEL_TITLE:"news_settings_panel_migration_warning_header",TITLE:"news_settings_panel_migration_warning_title",TEXT:"news_settings_panel_migration_warning_text_1",TEXT_2:"news_settings_panel_migration_warning_text_2",LEARN_MORE:"news_settings_panel_migration_warning_link",CTA:"news_settings_panel_migration_warning_CTA"},H={[d.LEGACY_WIX_APPS_NAMES.FAQ]:{PANEL_TITLE:"FAQ_settings_panel_migration_warning_header",TITLE:"FAQ_settings_panel_migration_warning_title",TEXT:"FAQ_settings_panel_migration_warning_text_1",TEXT_2:"FAQ_settings_panel_migration_warning_text_2",LEARN_MORE:"FAQ_settings_panel_migration_warning_link",CTA:"FAQ_settings_panel_migration_warning_CTA"},[d.LEGACY_WIX_APPS_NAMES.RESTAURANTS_MENUS]:{PANEL_TITLE:"menus_settings_panel_migration_warning_header",TITLE:"menus_settings_panel_migration_warning_title",TEXT:"menus_settings_panel_migration_warning_text_1",TEXT_2:"menus_settings_panel_migration_warning_text_2",LEARN_MORE:"menus_settings_panel_migration_warning_link",CTA:"menus_settings_panel_migration_warning_CTA_export"},[d.LEGACY_WIX_APPS_NAMES.NEWS_A]:z,[d.LEGACY_WIX_APPS_NAMES.NEWS_B]:z};var Q;!function(e){e.News="news",e.FAQ="faq",e.Menus="menu"}(Q||(Q={}));const K={[d.LEGACY_WIX_APPS_NAMES.FAQ]:Q.FAQ,[d.LEGACY_WIX_APPS_NAMES.RESTAURANTS_MENUS]:Q.Menus,[d.LEGACY_WIX_APPS_NAMES.NEWS_A]:Q.News,[d.LEGACY_WIX_APPS_NAMES.NEWS_B]:Q.News},J={TITLE:"news_exporting_to_collection_progress_bar_header",STEP_1:"news_exporting_to_collection_progress_bar_text1",STEP_2:"news_exporting_to_collection_progress_bar_text2",STEP_3:"news_exporting_to_collection_progress_bar_text3"};var $=a(15),Z=a.n($),ee=a(36);const te=e=>e.protocol&&e.address?"".concat(e.protocol,"://").concat(e.address):"",ae=(e,t)=>t.reduce((e,t)=>{const a=t.target,n=te(t);if(!n)return e;const i='target="'.concat(a,'" href="').concat(n,'"');return e.replace('dataquery="#'.concat(t.linkId,'"'),i)},e),ne=(e,t)=>{t(e),Array.from(e.children).forEach(e=>ne(e,t))},ie=e=>{const t=["text-align","font-weight","font-style","text-decoration"],a=document.createElement("div");return a.innerHTML=e,ne(a,e=>{Array.from(e.style).forEach(a=>{t.includes(a)||e.style.removeProperty(a)})}),a.innerHTML},se=(e,t)=>{const{src:a,title:n,width:i,height:s}=e,r=a.match(/^(http:\/\/)?(images\/.*)/);if(r){if(t){const e=y.serviceTopology.scriptsLocationMap.wixapps;return"".concat(e,"/javascript/wixapps/apps/").concat(t,"/").concat(r[2])}return null}return"wix:image://v1/".concat(a,"/").concat(n||a,"#originWidth=").concat(i,"&originHeight=").concat(s)},re=(e,t)=>(e=ae(e,t),e=(e=ie(e)).replace(/hatul/g,"p")),oe=e=>e===d.LEGACY_WIX_APPS_NAMES.NEWS_A||e===d.LEGACY_WIX_APPS_NAMES.NEWS_B,le=e=>".schemas/".concat(e,".json"),ce=e=>e.dsRead.platform.getAppDataByAppDefId(X.DATA_BINDING).applicationId,pe=async e=>{e.dsRead.wixCode.isProvisioned()||await new Promise((t,a)=>{e.dsActions.wixCode.provision({onSuccess:t,onError:a})})},de=e=>{e.dsActions.platform.notifyApplication(ce(e),{eventType:ee.EVENTS.enableDataModeClicked,eventPayload:{origin:"responsivePagesPanel/turnOnData"}})},me=e=>{e.panelManager.isPanelOpened("wixData.panel")||e.panelManager.openPanel("wixData.panel",{},null)},ue=async e=>{const t=await e.platform.requestAPIFromWorker(String(ce(e)));await t.refreshSchemasCache()};function _e(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ge(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const he=e=>{const t=e.map(e=>e.payload),a=e=>({title:e.title,id:e._iid,_createdAt:e._createdAt,_updatedAt:e._updatedAt}),n=t.map(({item:e})=>a(e)),i=t.map(e=>{const{item:t,referencedItems:n}=e;return t.items.map(e=>n["".concat(e.collectionId,"/").concat(e.itemId)]).map(e=>function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(a),!0).forEach((function(t){ge(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_e(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},a(e),{image:se(e.image,Q.News),createdDate:e.date.iso,createdBy:e.newsSource,createdByLink:te(e.newsSourceLink),description:re(e.content.text,e.content.links),sections:e.parentRefs.map(e=>e.itemId)}))});return{sections:_.a.flatten(n),news:_.a.flatten(i)}};function Pe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function fe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Ee=(e,t)=>({id:e._iid,title:e.title,weight:t+1}),ye=e=>{const{payload:t}=e,{item:a,referencedItems:n}=t,i=e=>n["".concat(e.collectionId,"/").concat(e.itemId)],s="categories"in a?a.categories.map(i):[a];return{categories:s.map(Ee),questions:_.a.flatMap(s,e=>_.a.flatMap(e.questions,e=>{return(t=i(e)).parentRefs.map(e=>({category:e.itemId,demo:!1,id:t._iid,title:{text:t.question},text:{imageList:[],videoList:[],text:ie(t.answer.text),links:t.answer.links}}));var t})).map((e,t)=>function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(a),!0).forEach((function(t){fe(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Pe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e,{weight:t+1}))}};function Ae(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function be(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(a),!0).forEach((function(t){Oe(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ae(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Oe(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Te=e=>{const t=(e,t)=>e["".concat(t.collectionId,"/").concat(t.itemId)],a=e=>({description:e.description,title:e.title,id:e._iid}),n=e=>be({},a(e),{},e.image&&{image:se(e.image,Q.Menus)},{parentMenuId:e.parentRef.itemId}),i=e.map(e=>e.payload),s=i.map(e=>{return t=e.item,a(t);var t}),r=i.reduce((e,a)=>{const{item:n,referencedItems:i}=a,s=n.items.map(e=>t(i,e)),r=s.filter(e=>void 0!==e.items),o=s.filter(e=>void 0===e.items),l=r.reduce((e,a)=>[...e,...a.items.map(e=>t(i,e))],[]);return{dishes:[...e.dishes,...l],sections:[...e.sections,...r],orphanedDishes:[...e.orphanedDishes,...o]}},{dishes:[],sections:[],orphanedDishes:[]});r.orphanedDishes=r.orphanedDishes.map(e=>be({},e,{parentRefs:[{itemId:"new-section"}]}));const o=[...r.dishes,...r.orphanedDishes].map(e=>be({},a(e),{},e.image&&{image:se(e.image,Q.Menus)},{price:e.price,menuSections:_.a.uniq(e.parentRefs.map(e=>e.itemId))})),l=r.sections.map(n);return r.orphanedDishes.length&&l.push(n({_iid:"new-section",title:Object(p.translate)("menus_content_collection_sections_field_generic_section"),description:"",parentRef:{itemId:s[0].id}})),{menus:s,sections:l,dishes:o}},Se=e=>({collectionId:t,itemId:a})=>Z.a.requestsUtil.fetchJson("https://editor.wix.com/apps/lists/1/ReadItem?consistentRead=true",{method:"POST",headers:new Headers({"Content-Type":"application/json; charset=UTF-8"}),body:JSON.stringify({autoDereferenceLevel:3,collectionId:t,itemId:a,storeId:e})}),Ie=e=>_()(e).map(e=>e.appLogicParams).filter(({collectionId:e,itemId:t})=>Boolean(e&&t)).map(({collectionId:e,itemId:t})=>({collectionId:e.value,itemId:t.value})).uniqBy(({collectionId:e,itemId:t})=>"".concat(e,"/").concat(t)).value();var we=a(1034);class Ne{constructor(e){this.readAndParseFile=async e=>{const t=await this.fileSystem.readFile(e);return JSON.parse(t)},this.getSchemaVirtualDescriptor=e=>{const t=(e=>".schemas/".concat(e,".json"))(e);return this.fileSystem.getVirtualDescriptor(t)},this.loadSchema=async e=>{const{getSchemaVirtualDescriptor:t,readAndParseFile:a}=this,n=t(e);return await a(n)},this.listSchemas=async()=>{const{fileSystem:e,readAndParseFile:t}=this,a=e.getRoots().schemas,n=await e.getChildren(a);return await Promise.all(n.map(t))},this.saveSchema=async(e,t)=>{const{fileSystem:a,getSchemaVirtualDescriptor:n}=this,i=n(e);await a.writeFile(i,JSON.stringify(t)),await a.flush()},this.removeSchema=async e=>{const{fileSystem:t,getSchemaVirtualDescriptor:a}=this,n=a(e);await t.deleteFile(n),await t.flush()},this.fileSystem=e}}const Le=e=>Object(we.createCollectionsApi)({transportLayer:new Ne(e)});var ve=a(1122),Ce=a.n(ve),xe=a(1133),je=a.n(xe);const Re=e=>{const t=Ce()("https://code-dev.apps.wix.com/api",new URLSearchParams({instance:e.dsRead.wixCode.getClientSpec().instance,viewMode:"preview",gridAppId:e.wixCode.fileSystem.getViewerInfo().gridAppId}).toString(),"",{withCredentials:!0});return je()(t)},ke=(e,t)=>{const[a]=t.selectedComponent,n=e.components.data.get(a);return null==n?void 0:n.appPartName},De=({editorAPI:e,state:t},a)=>{const n=ke(e,a),i=e.dsRead.platform.getAppDataByAppDefId(X.DATA_BINDING),s=Boolean(i);return{helpId:d.LEGACY_WIX_APPS_NAMES_TO_HELP_ID_MAP[n],isDataBindingAppInstalled:s,isNewsMigrated:G.userPreferences.selectors.getSiteUserPreferences(d.default.USER_PREFS.WIX_APPS_MIGRATION.IS_NEWS_MIGRATED)(t),isMenusMigrated:G.userPreferences.selectors.getSiteUserPreferences(d.default.USER_PREFS.WIX_APPS_MIGRATION.IS_MENUS_MIGRATED)(t),appPartName:n,componentType:n,translations:H[n]}},Fe=(e,t,{editorAPI:a})=>a,Me=(e,t)=>{const a=e(Fe),n=()=>{e(G.panels.actions.closePanelByName(t.panelName))},i=a=>{const[n]=t.selectedComponent;e(G.bi.actions.event({evid:1050},{target:a,component_id:n.id}))},s=e=>{y.ravenUtils.captureError(e,{tags:{wixAppsMigration:!0},extra:{appPartName:ke(a,t)}})},r=async()=>{i("migrate-news");try{y.fedopsLogger.interactionStarted(y.fedopsLogger.INTERACTIONS.WIXAPPS.WIXAPPS_MIGRATE_NEWS),a.history.add("migrate-wixapps"),a.panelHelpers.openProgressBar(Object(p.translate)(J.TITLE),2);const t=await(async e=>{const t=Se(e.wixapps.classics.getDataStoreId(K[d.LEGACY_WIX_APPS_NAMES.NEWS_A])),a=e.wixapps.classics.getAllAppPartComps().filter(e=>oe(e.appPartName)),n=Ie(a),i=await Promise.all(n.map(t));return he(i.filter(e=>e.success))})(a);await(async(e,{sections:t,news:a})=>{e.panelHelpers.updateProgressBar(0,Object(p.translate)(J.STEP_1)),await pe(e),de(e),e.panelHelpers.updateProgressBar(1,Object(p.translate)(J.STEP_2));const n=Le(e.wixCode.fileSystem),i=Date.now(),s="news-".concat(i),r="news-sections-".concat(i),o=Object(we.createSchema)(s,Object(we.setDisplayName)(Object(p.translate)("news_content_collection_items_name")),Object(we.addField)("title",{type:"text",displayName:Object(p.translate)("news_content_collection_items_field_title")}),Object(we.addField)("description",{type:"richtext",displayName:Object(p.translate)("news_content_collection_items_field_description")}),Object(we.addField)("createdDate",{type:"datetime",displayName:Object(p.translate)("news_content_collection_items_field_created_date")}),Object(we.addField)("createdBy",{type:"text",displayName:Object(p.translate)("news_content_collection_items_field_created_by_text")}),Object(we.addField)("createdByLink",{type:"text",displayName:Object(p.translate)("news_content_collection_items_field_created_by_link")}),Object(we.addField)("image",{type:"image",displayName:Object(p.translate)("news_content_collection_items_field_image")}),Object(we.setPermissions)(Object(we.getPermissionsByPreset)(we.PRESETS.CONTENT_FOR_YOUR_SITE))),l=Object(we.updateSchema)(s,Object(we.addField)("sections",{type:"multi-reference",displayName:Object(p.translate)("news_content_collection_sections_name"),referencingFieldKey:"sections",referencingDisplayName:Object(p.translate)("news_content_collection_sections_name"),referencedCollection:r})),c=Object(we.createSchema)(r,Object(we.setDisplayName)(Object(p.translate)("news_content_collection_sections_name")),Object(we.addField)("title",{type:"text",displayName:Object(p.translate)("news_content_collection_sections_field_name")}),Object(we.setPermissions)(Object(we.getPermissionsByPreset)(we.PRESETS.CONTENT_FOR_YOUR_SITE))),d=Object(we.updateSchema)(r,Object(we.addField)("sections",{type:"multi-reference",displayName:Object(p.translate)("news_content_collection_items_name"),referencingFieldKey:"sections",referencingDisplayName:Object(p.translate)("news_content_collection_items_name"),referencedCollection:s}));await n.execute(o),await n.execute(c),await n.execute(l),await n.execute(d);const m=Re(e),u=a.map(e=>({_owner:y.editorModel.permissionsInfo.ownerId,title:e.title,image:e.image,createdDate:{$date:e.createdDate},createdBy:e.createdBy,createdByLink:e.createdByLink,description:e.description,sections:e.sections}));await m.bulkInsert(r,t.map(e=>({_owner:y.editorModel.permissionsInfo.ownerId,_id:e.id,title:e.title})));const g=await m.bulkInsert(s,u);await Promise.all(_.a.flatten(g.insertedItemIds.map((e,t)=>u[t].sections.map(t=>m.insertReference(s,"sections",e,t))))),await ue(e),e.panelHelpers.updateProgressBar(2,Object(p.translate)(J.STEP_3)),await new Promise(e=>setTimeout(e,1e3)),me(e)})(a,t),y.fedopsLogger.interactionEnded(y.fedopsLogger.INTERACTIONS.WIXAPPS.WIXAPPS_MIGRATE_NEWS),e(G.userPreferences.actions.setSiteUserPreferences(d.default.USER_PREFS.WIX_APPS_MIGRATION.IS_NEWS_MIGRATED,!0))}catch(e){s(e)}await a.panelHelpers.closeProgressBar()},o={[d.LEGACY_WIX_APPS_NAMES.RESTAURANTS_MENUS]:async()=>{i("migrate-menus");try{y.fedopsLogger.interactionStarted(y.fedopsLogger.INTERACTIONS.WIXAPPS.WIXAPPS_MIGRATE_MENUS),a.history.add("migrate-wixapps"),a.panelHelpers.openProgressBar(Object(p.translate)("menus_exporting_to_collection_progress_bar_header"),2);const t=await(async e=>{const t=Se(e.wixapps.classics.getDataStoreId(K[d.LEGACY_WIX_APPS_NAMES.RESTAURANTS_MENUS])),a=e.wixapps.classics.getAllAppPartComps().filter(e=>e.appPartName===d.LEGACY_WIX_APPS_NAMES.RESTAURANTS_MENUS),n=Ie(a),i=await Promise.all(n.map(t));return Te(i.filter(e=>e.success))})(a);n(),await(async(e,{menus:t,sections:a,dishes:n})=>{e.panelHelpers.updateProgressBar(0,Object(p.translate)("menus_exporting_to_collection_progress_bar_text1")),await pe(e),de(e),e.panelHelpers.updateProgressBar(1,Object(p.translate)("menus_exporting_to_collection_progress_bar_text2"));const i=Le(e.wixCode.fileSystem),s=Date.now(),r="menus-".concat(s),o="menu-sections-".concat(s),l="dishes-".concat(s),c=Object(we.createSchema)(r,Object(we.setDisplayName)(Object(p.translate)("menus_content_collection_menus_name")),Object(we.addField)("title",{type:"text",displayName:Object(p.translate)("menus_content_collection_menus_field_title")}),Object(we.addField)("description",{type:"text",displayName:Object(p.translate)("menus_content_collection_menus_field_description")}),Object(we.setPermissions)(Object(we.getPermissionsByPreset)(we.PRESETS.CONTENT_FOR_YOUR_SITE))),d=Object(we.updateSchema)(r,Object(we.addField)("menus",{type:"multi-reference",displayName:Object(p.translate)("menus_content_collection_sections_name"),referencingFieldKey:"menus",referencingDisplayName:Object(p.translate)("menus_content_collection_menus_name"),referencedCollection:o})),m=Object(we.createSchema)(o,Object(we.setDisplayName)(Object(p.translate)("menus_content_collection_sections_name")),Object(we.addField)("title",{type:"text",displayName:Object(p.translate)("menus_content_collection_sections_field_title")}),Object(we.addField)("description",{type:"text",displayName:Object(p.translate)("menus_content_collection_sections_field_description")}),Object(we.addField)("image",{type:"image",displayName:Object(p.translate)("menus_content_collection_sections_field_image")}),Object(we.setPermissions)(Object(we.getPermissionsByPreset)(we.PRESETS.CONTENT_FOR_YOUR_SITE))),u=Object(we.updateSchema)(o,Object(we.addField)("sections",{type:"multi-reference",displayName:Object(p.translate)("menus_content_collection_dishes_name"),referencingFieldKey:"sections",referencingDisplayName:Object(p.translate)("menus_content_collection_sections_name"),referencedCollection:l}),Object(we.addField)("menus",{type:"multi-reference",displayName:Object(p.translate)("menus_content_collection_menus_name"),referencingFieldKey:"menus",referencingDisplayName:Object(p.translate)("menus_content_collection_sections_name"),referencedCollection:r})),g=Object(we.createSchema)(l,Object(we.setDisplayName)(Object(p.translate)("menus_content_collection_dishes_name")),Object(we.addField)("title",{type:"text",displayName:Object(p.translate)("menus_content_collection_dishes_field_title")}),Object(we.addField)("price",{type:"text",displayName:Object(p.translate)("menus_content_collection_dishes_field_price")}),Object(we.addField)("description",{type:"text",displayName:Object(p.translate)("menus_content_collection_dishes_field_description")}),Object(we.addField)("image",{type:"image",displayName:Object(p.translate)("menus_content_collection_dishes_field_image")}),Object(we.setPermissions)(Object(we.getPermissionsByPreset)(we.PRESETS.CONTENT_FOR_YOUR_SITE))),h=Object(we.updateSchema)(l,Object(we.addField)("sections",{type:"multi-reference",displayName:Object(p.translate)("menus_content_collection_sections_name"),referencingFieldKey:"sections",referencingDisplayName:Object(p.translate)("menus_content_collection_dishes_name"),referencedCollection:o}));await i.execute(c),await i.execute(m),await i.execute(g),await i.execute(d),await i.execute(u),await i.execute(h);const P=Re(e);await P.bulkInsert(r,t.map(e=>({_id:e.id,_owner:y.editorModel.permissionsInfo.ownerId,title:e.title,description:e.description}))),await P.bulkInsert(o,a.map(e=>({_id:e.id,_owner:y.editorModel.permissionsInfo.ownerId,title:e.title,description:e.description,image:e.image}))),await Promise.all(a.map(e=>P.insertReference(o,"menus",e.id,e.parentMenuId))),await P.bulkInsert(l,n.map(e=>({_id:e.id,_owner:y.editorModel.permissionsInfo.ownerId,title:e.title,description:e.description,image:e.image,price:e.price}))),await Promise.all(_.a.flatten(n.map(e=>e.menuSections.map(t=>P.insertReference(l,"sections",e.id,t))))),await ue(e),e.panelHelpers.updateProgressBar(2,Object(p.translate)("menus_exporting_to_collection_progress_bar_text3")),await new Promise(e=>setTimeout(e,1e3)),me(e)})(a,t),y.fedopsLogger.interactionEnded(y.fedopsLogger.INTERACTIONS.WIXAPPS.WIXAPPS_MIGRATE_MENUS),e(G.userPreferences.actions.setSiteUserPreferences(d.default.USER_PREFS.WIX_APPS_MIGRATION.IS_MENUS_MIGRATED,!0))}catch(e){s(e)}await a.panelHelpers.closeProgressBar()},[d.LEGACY_WIX_APPS_NAMES.FAQ]:async()=>{try{y.fedopsLogger.interactionStarted(y.fedopsLogger.INTERACTIONS.WIXAPPS.WIXAPPS_MIGRATE_FAQ),a.history.add("migrate-wixapps");const t=await(async e=>{var t,a;const{getDataStoreId:n}=e.wixapps.classics,{appLogicParams:i}=e.selection.getSelectedComponentData(),s=null===(t=i.collectionId)||void 0===t?void 0:t.value,r=null===(a=i.itemId)||void 0===a?void 0:a.value,o=n(K[d.LEGACY_WIX_APPS_NAMES.FAQ]),l=Se(o),c=await l({collectionId:s,itemId:r});return c.success?ye(c):null})(a);e=Y.WIX_FAQ,U.appMarketHandlers.addApp(a,{appDefId:e}),i((e=>({[Y.WIX_FAQ]:"install-faq"}[e]))(e)),n(),await(async(e,{categories:t,questions:a})=>{await new Promise(t=>{e.tpa.app.registerOnInstalled(Y.WIX_FAQ,t)});const{instance:n,applicationId:i,settingsUrl:s}=e.tpa.app.getDataByAppDefId(Y.WIX_FAQ),r=e.tpa.app.getRenderedReactCompsByApplicationId(i),o=r[r.length-1],l=new URL(s).origin,c=new URLSearchParams({instance:n,compId:o.id,originCompId:"",isSite:"false"});await Z.a.requestsUtil.fetchJson("".concat(l,"/api/faq?").concat(c),{method:"PUT",headers:new Headers({"Content-Type":"application/json; charset=UTF-8"}),body:JSON.stringify({FAQItems:{categories:t,questions:a}})}),e.tpa.app.refreshApp(o)})(a,t),y.fedopsLogger.interactionEnded(y.fedopsLogger.INTERACTIONS.WIXAPPS.WIXAPPS_MIGRATE_FAQ)}catch(e){s(e)}var e},[d.LEGACY_WIX_APPS_NAMES.NEWS_A]:r,[d.LEGACY_WIX_APPS_NAMES.NEWS_B]:r};return{openHelpCenter:n=>{e(G.panels.actions.openHelpCenter(n,null,{learn_more:!0,component:ke(a,t)}))},handleCTAButtonClick:()=>{const e=ke(a,t);o[e]()}}};class We extends r.a.Component{constructor(){super(...arguments),this.handleHelpClick=()=>{const{openHelpCenter:e,helpId:t}=this.props;e(t)}}shouldDisplayCTA(){const{appPartName:e,isNewsMigrated:t,isMenusMigrated:a}=this.props;return oe(e)?!t:e!==d.LEGACY_WIX_APPS_NAMES.RESTAURANTS_MENUS||!a}render(){const{frameProps:e,helpId:t,componentType:a,translations:n,appPartName:i,handleCTAButtonClick:s}=this.props;return V.includes(i)?r.a.createElement(c.compPanelFrame,Object.assign({shouldTranslate:!1,title:Object(p.translate)(n.PANEL_TITLE),automationId:q.PANEL_FRAME,helpId:t,selectedComponentType:a},e),r.a.createElement(o.Composites.RichTextWithIllustrationVertical,null,r.a.createElement(o.Illustration,null,r.a.createElement(m.symbol,{name:"emptyStateRestrictedAreaRoadblock"})),r.a.createElement(o.Composites.RichTextLabeled,null,r.a.createElement(o.TextLabel,{type:"T09",shouldTranslate:!1,value:Object(p.translate)(n.TITLE)}),r.a.createElement(o.RichText,{className:"light",type:"T07"},r.a.createElement("p",null,Object(p.translate)(n.TEXT)),n.TEXT_2&&r.a.createElement("p",null,Object(p.translate)(n.TEXT_2)),r.a.createElement("a",{onClick:this.handleHelpClick,"data-aid":q.LEARN_MORE},Object(p.translate)(n.LEARN_MORE)),this.shouldDisplayCTA()&&r.a.createElement(o.Composites.ButtonLarge,null,r.a.createElement(o.Button,{onClick:s,automationId:q.CTA,ellipsis:!0},Object(p.translate)(n.CTA))))))):r.a.createElement(B,this.props)}}We.displayName="WixAppsDeprecationPanel",We.defaultProps={handleCTAButtonClick:()=>{}};var Be=(e=>{const t=_.a.flow(y.hoc.connect(y.hoc.STORES.EDITOR_API,De,Me),G.components.hoc.compPanel)(e);return t.pure=e,t})(We),Xe=h()({displayName:"WixappsLayoutPanel",mixins:[c.compPanelMixin,c.wixappsPanelMixin],getCustomizations(){return this.getAvailableCustomizations("layout")},getViewOptions(){return this.getAvailableViewNames().map((function(e){return{title:e,value:e,symbolName:e}}))},getLanguageDirectionOptions(){return this.getEditorAPI().viewMode.get()===this.getEditorAPI().dsRead.viewMode.VIEW_MODES.DESKTOP&&this.isRTLAllowed()&&[{value:"ltr",symbolName:"alignLeft"},{value:"rtl",symbolName:"alignRight"}]},isDesktopViewMode(){return"DESKTOP"===this.getEditorAPI().viewMode.get()},render(){return r.a.createElement(c.compPanelFrame,Object.assign({title:"".concat(this.getSelectedAppPartDisplayName(),"_layout"),contentClass:"settings-panel",helpId:this.getComponentHelpIdByType("layout")},this.getFrameProps()),this.isDesktopViewMode()&&this.getViewOptions().length>1?r.a.createElement("div",{key:"desktop-view"},r.a.createElement(P.thumbnails,{maxThumbsPerRow:"3",title:"APP_PART_CHOOSE_LAYOUT",options:this.getViewOptions(),valueLink:this.linkedData("viewName")})):null,this.isDesktopViewMode()&&this.getViewOptions().length>1&&this.getLanguageDirectionOptions()?r.a.createElement("hr",{key:"wixapps-layout-separator",className:"divider-long"}):null,r.a.createElement("div",null,this.getLanguageDirectionOptions()?(()=>{const e=this.getLanguageDirectionOptions();return r.a.createElement(P.thumbnails,{maxThumbsPerRow:"5",key:"lang",options:e,title:"APP_PART_CHOOSE_LAYOUT_POST_ALIGNMENT",valueLink:this.linkedProperty("direction")})})():null),r.a.createElement(l.a.Divider,{long:!0}),r.a.createElement(k,{customizations:this.getCustomizations(),compPanel:this}))}});var Ge=h()({displayName:"singlePostPageOnlyCompsTooltip",mixins:[D.mixins.editorAPIMixin],goToSinglePost(){const e=this.getEditorAPI(),t=_.a.find(e.dsRead.pages.getPagesData(),{appPageId:"7326bfbb-4b10-4a8e-84c1-73f776051e10"});this.close(),e.pages.navigateTo(t.id)},close(){this.getEditorAPI().hideFloatingBubble()},render(){return r.a.createElement(P.popoverTemplates.quickTip,{text:"BLOG_RELATED_POSTS_DISABLE_TOOLTIP_TEXT",linkActionText:"BLOG_RELATED_POSTS_DISABLE_TOOLTIP_LINK",symbol:"idea-bulb",linkAction:this.goToSinglePost,closeAction:this.close})}});function Ue(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ve(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const Ye=function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(a),!0).forEach((function(t){Ve(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ue(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},i,{createWixCodeCollectionsAPI:Re}),qe=e=>{const t=e.dsRead.wixapps.appbuilder,a=e.dsActions.wixapps.appbuilder;return T.a.isOpen("se_disableAppBuilderLayoutCalls")?{setListLayout(){},getListLayout:()=>({}),setItemTemplate(){},setField(){},getField:()=>({}),getAllFields:()=>[]}:{setListLayout:(...e)=>a.layout.setListLayout(...e),getListLayout:(...e)=>t.layout.getListLayout(...e),setItemTemplate:(...e)=>a.layout.setItemTemplate(...e),setField:(...e)=>a.layout.setField(...e),getField:(...e)=>a.layout.getField(...e),getAllFields:(...e)=>t.layout.getAllFields(...e)}},ze={settingsPanel:Be,layoutPanel:Xe,singlePostPageOnlyCompsTooltip:Ge}}}]);